<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_oportunidad_search" model="ir.ui.view">
        <field name="name">oportunidad.search</field>
        <field name="model">oportunidad</field>
        <field name="arch" type="xml">
            <search>
                <field name="custom_id"/>
                <field name="estado"/>
                <field name="persona_id"/>
                <field name="fecha_oportunidad"/>

                <!-- FILTROS-->
                <filter name="filtro_finalizada" string="Finalizada" help="Filtrado por estado finalizado"
                        domain="[('estado', '=', 'finalizada')]"/>

                <!-- Sintaxis para añadir un group by-->
                <group expand="0" string="Group By">
                    <filter string="Estado" name="group_by_estado" help="Agrupación por estados"
                            context="{'group_by':'estado'}"/>
                </group>

                <searchpanel>
                    <field name="estado" enable_counters="1"/>
                </searchpanel>
            </search>
        </field>
    </record>


    <record id="view_oportunidad_tree" model="ir.ui.view">
        <field name="name">oportunidad.tree</field>
        <field name="model">oportunidad</field>
        <field name="arch" type="xml">
            <tree   decoration-success="estado == 'finalizada'"
                    decoration-danger="estado == 'cancelada'">
                <field name="id"/>
                <field name="custom_id"/>
                <field name="estado"
                       widget="badge"
                       decoration-success="estado == 'finalizada'"
                       decoration-info="estado == 'nueva'"
                       decoration-muted="estado == 'en_proceso'"
                       decoration-danger="estado == 'cancelada'"
                       decoration-warning="estado == 'suspendida'"/>
                <field name="ref"/>
                <field name="persona_id"/>
                <field name="fecha_oportunidad"/>
            </tree>
        </field>
    </record>

    <record id="view_oportunidad_form" model="ir.ui.view">
        <field name="name">oportunidad.form</field>
        <field name="model">oportunidad</field>
        <field name="arch" type="xml">
            <form> <!-- en base a esto odoo determina el tipo de vista, acá si ponés tree, va a ser tree. -->
                <header>
                    <field name="estado" widget="statusbar" nolabel="1" options="{'clickable': '1'}"
                           statusbar_visible="nueva, en_proceso, finalizada"/> <!-- No se muestra ni suspendida, ni cancelada -->
                    <button name="cancelar_oportunidad"
                            confirm="Estas seguro de que quieres cancelar la oportunidad?"
                            help="Al clickear se cancelará la oportunidad"
                            type="object" string="Cancelar oportunidad" class="oe_highlight"/>
                    <button name="suspender_oportunidad"
                            confirm="Estas seguro de que quieres suspender la oportunidad?"
                            help="Al clickear se suspenderá la oportunidad"
                            type="object" string="Suspender oportunidad" />
                </header>
                <sheet>
                    <h1>INGRESE LOS DATOS</h1>
                    <div style="border: 0; height: 6px; background: linear-gradient(to right, #5cadff, #2a5298); margin: 20px 0; border-radius: 5px;">
                    </div>
                    <p/>
                    <group>
                        <group>
                            <field name="custom_id" readonly="False"/>
                            <field name="fecha_oportunidad"/>
                            <field name="prioridad" widget="priority"/>
                        </group>
                        <group>
                            <field name="persona_id"/>
                            <field name="persona_genero" readonly="False"/>
                        </group>
                        <group string="Coordenadas" style="font-size: 12px; color: #666;">
                            <field name="latitud" label="Latitud" style="width: 100px;"/>
                            <field name="longitud" label="Longitud" style="width: 100px;"/>
                        </group>
                        <group>
                            <field name="ref"/>
                            <button name="action_test"
                                    confirm="Estas seguro de ejecutar el código de python?"
                                    help="Al clickear se hará un print en la consola y mostrará un arcoíris"
                                    type="object" string="Boton objeto" class="oe_highlight"/>
                            <button name="%(addon_prueba.action_persona)d"
                                    confirm="Estas seguro de ir a la acción persona?"
                                    help="Al clickear te dirigirás a la lista de personas"
                                    type="action" string="Boton accion"/>
                        </group>
                        <p/>

                    </group>

                    <notebook>

                        <!-- Ventana Descripción en HTML -->
                        <page string="Descripción" name="descripcion">
                            <field name="descripcion" placeholder="Ingrese la descripción de la oportunidad"/>
                        </page>

                        <!-- Ventana Personas -> en un futuro implementarlo como un tree -->
                        <page string="Personas" name="personas">
                            <field name="persona_id"/>
                            <field name="persona_genero" readonly="False"/>
                        </page>

                    </notebook>


                </sheet>

            </form>
        </field>
    </record>


    <record id="action_oportunidades" model="ir.actions.act_window">
        <field name="name">Oportunidades</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">oportunidad</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{}</field> <!-- 'search_default_group_by_estado': 1 -->
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Todavía no creaste ninguna Oportunidad!
            </p>
        </field>
    </record>

    <menuitem id="menu_oportunidades_detalle"
              parent="menu_oportunidades"
              name="Oportunidades"
              sequence="0"
              action="action_oportunidades"
    />

</odoo>